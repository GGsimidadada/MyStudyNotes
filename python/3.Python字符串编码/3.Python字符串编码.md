### 字符编码

计算机只能处理数字，如果要处理文本，就必须先把文本转换为数字才能处理。

在最早的计算机设计时采用8个比特(bit)作为一个字节(byte)，所以一个字节能表示的最大整数就是255(即二进制的11111111)。两个字节能表示的最大整数是65535.

最早只有127个字符被编码到计算机里，也就是大小写英文字母、数字和一些符号，这个编码表被称为`ASCII`编码。

但是用一个字节来表示中文是远远不够的，至少需要两个字节，而且还不能和`ASCII`编码冲突，所以中国制定了`GB2312`编码，用来把中文编进去。

不同的国家用不同的标准来编码语言，不可避免的会造成编码冲突，结果就是在多语言混合的文本中，会出现乱码的情况。为了解决这个问题，`Unicode`应运而生。它把所有的语言都统一到一套编码中，这样就不会再有乱码的问题了。

`Unicode`最常用的是用两个字节表示一个字符(如果遇到生僻字就需要4个字节)。如果需要表示英文，则在`ASCII`编码的基础上，在前面补0即可。

但是这样会出现一个问题：如果文本中英文比较多的话，用`Unicode`编码会比`ASCII`编码多需要一倍的存储空间，在传输和储存上非常不划算。

因此，又出现了把`Unicode`编码转化为“可变长编码”的`UTF-8`编码。在`UTF-8`编码中，常用的英文字母被编码成1个字节，汉字被编码成3个字节，生僻的字符会被编码成4-6个字节。而且，还有一个好处，`ASCII`编码可以被视为是`UTF-8`编码的一部分。

##### 总结现在计算机系统通用的字符编码工作方式：

在计算机内存中，统一使用Unicode编码，当需要保存到硬盘或者传输的时候，就转换为UTF-8编码。

在用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到内存里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件。

浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器。



### Python字符串

在最新的Python 3版本中，字符串是以Unicode编码的，也就是说，Python字符串支持多语言。

在Python中，可以使用`ord()`函数获取字符的十进制编码，`chr()`函数把十进制编码转换为对应的字符。

Python中字符串类型是`str`，在内存中以Unicode表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把`str`变为以字节为单位的`bytes`。

Python对`bytes`类型的数据用带`b`前缀的单引号或双引号表示。

以Unicode表示的`str`可以通过`encode()`方法编码为指定的`bytes`。例如：

```python
'ABC'.encode('ascii')
'中文'.encode('utf-8')
```

注意：中文不能用ASCII来进行编码，因为超过了它的编码范围，Python会报错。

在Python中，无法显示为ASCII字符的字节，用`\x##`显示。

如果需要将`bytes`转为`str`，需要用到`decode()`函数：

```python
b'ABC'.decode('ASCII')
```

`len()`函数可以计算`str`的字符数，也可以计算`bytes`的字节数：

```python
len('ABC')
len(b'ABC')
```

在`str`和`bytes`互相转换时，为了避免乱码，应该坚持使用`UTF-8`转码。

由于Python的源代码也是一个文本文件，所以当源代码中包含中文时，在保存源代码时，就需要务必指定保存为UTF-8编码。可以再文件开头写上这两行：

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
```

第一行注释是为了告诉Linux/OS X系统，这是一个Python可执行程序，Windows系统会忽略这个注释；

第二行注释是为了告诉Python解释器，按照UTF-8编码读取源代码，否则在源代码中的中文可能会出现乱码。

### 格式化

在Python中，`%`可以用来格式化字符串（相当于用变量代替字符串中的某个值），在字符串内部，使用`%?`来占位。字符串中有几个`%?`占位符，`%`符号后面就跟几个变量或者值，顺序要对应好。如果只有一个占位符，那么括号可以省略。

常见的占位符：

1. %d：整数
2. %f：浮点数
3. %s：字符串
4. %x：十六进制整数

其中，格式化整数和浮点数还可以指定是否补0和整数与小数的位数。

`%%`用来表示一个普通的符号`%`。

